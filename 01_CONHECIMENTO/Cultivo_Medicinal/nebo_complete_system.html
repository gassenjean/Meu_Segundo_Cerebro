<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üå± NEBO CLOUD - Sistema Completo</title>
    <meta name="description" content="Sistema inteligente para cultivo medicinal org√¢nico">
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#10b981">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="NEBO Cloud">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #10b981;
            --primary-dark: #059669;
            --secondary: #3b82f6;
            --background: #0f172a;
            --surface: #1e293b;
            --text: #e2e8f0;
            --text-secondary: #94a3b8;
            --border: #334155;
            --success: #22c55e;
            --warning: #f59e0b;
            --error: #ef4444;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, var(--background) 0%, var(--surface) 100%);
            color: var(--text);
            min-height: 100vh;
            line-height: 1.6;
        }

        .header {
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border);
            padding: 1rem 2rem;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .status-badge {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid var(--primary);
            border-radius: 20px;
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .live-dot {
            width: 8px;
            height: 8px;
            background: var(--primary);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        .grid {
            display: grid;
            gap: 2rem;
        }

        .grid-2 {
            grid-template-columns: 2fr 1fr;
        }

        .card {
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 1.5rem;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid var(--border);
        }

        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .metric-card {
            background: rgba(51, 65, 85, 0.5);
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .metric-card:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
        }

        .metric-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        .metric-label {
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .timeline {
            position: relative;
            padding-left: 2rem;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 0.75rem;
            top: 0;
            bottom: 0;
            width: 2px;
            background: linear-gradient(to bottom, var(--primary), var(--secondary));
        }

        .timeline-item {
            position: relative;
            margin-bottom: 1.5rem;
            padding-left: 1rem;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -0.5rem;
            top: 0.25rem;
            width: 10px;
            height: 10px;
            background: var(--primary);
            border-radius: 50%;
            border: 2px solid var(--background);
        }

        .timeline-item.urgent::before {
            background: var(--warning);
            animation: pulse 1s infinite;
        }

        .timeline-date {
            font-size: 0.875rem;
            color: var(--primary);
            font-weight: 600;
        }

        .timeline-content {
            margin-top: 0.25rem;
        }

        .timeline-title {
            font-weight: 600;
            color: var(--text);
        }

        .timeline-desc {
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-top: 0.25rem;
        }

        .alert {
            background: rgba(251, 191, 36, 0.1);
            border: 1px solid var(--warning);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
        }

        .alert-title {
            font-weight: 600;
            color: var(--warning);
            margin-bottom: 0.5rem;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: rgba(59, 130, 246, 0.2);
            color: var(--secondary);
            border: 1px solid var(--secondary);
        }

        .btn-secondary:hover {
            background: rgba(59, 130, 246, 0.3);
        }

        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .action-card {
            background: rgba(51, 65, 85, 0.5);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .action-card:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
        }

        .action-card.urgent {
            border-color: var(--warning);
            box-shadow: 0 0 20px rgba(245, 158, 11, 0.3);
            animation: urgent-glow 2s infinite;
        }

        @keyframes urgent-glow {
            0%, 100% { box-shadow: 0 0 20px rgba(245, 158, 11, 0.3); }
            50% { box-shadow: 0 0 30px rgba(245, 158, 11, 0.6); }
        }

        .action-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }

        .action-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .action-subtitle {
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .floating-voice {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 60px;
            height: 60px;
            background: var(--primary);
            border-radius: 50%;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 8px 32px rgba(16, 185, 129, 0.3);
            transition: all 0.3s ease;
            z-index: 200;
        }

        .floating-voice:hover {
            transform: scale(1.1);
            box-shadow: 0 12px 40px rgba(16, 185, 129, 0.5);
        }

        .floating-voice.recording {
            background: var(--error);
            animation: voice-pulse 1s infinite;
        }

        @keyframes voice-pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 300;
        }

        .modal-content {
            background: rgba(30, 41, 59, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 2rem;
            margin: 1rem;
            max-width: 500px;
            width: 100%;
            text-align: center;
        }

        .voice-status {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(16, 185, 129, 0.95);
            color: white;
            padding: 1rem 2rem;
            border-radius: 12px;
            font-weight: 600;
            display: none;
            z-index: 400;
            box-shadow: 0 8px 32px rgba(16, 185, 129, 0.3);
        }

        .data-display {
            display: grid;
            gap: 1rem;
            margin: 1rem 0;
        }

        .data-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            background: rgba(51, 65, 85, 0.3);
            border-radius: 8px;
            border: 1px solid var(--border);
        }

        .success-banner {
            background: rgba(34, 197, 94, 0.1);
            border: 1px solid var(--success);
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            text-align: center;
        }

        .notification {
            position: fixed;
            top: 2rem;
            right: 2rem;
            background: var(--primary);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 8px;
            box-shadow: 0 8px 32px rgba(16, 185, 129, 0.3);
            transform: translateX(100%);
            transition: transform 0.3s ease;
            z-index: 500;
        }

        .notification.show {
            transform: translateX(0);
        }

        @media (max-width: 768px) {
            .grid-2 {
                grid-template-columns: 1fr;
            }
            
            .container {
                padding: 1rem;
            }
            
            .header {
                padding: 1rem;
            }
            
            .header-content {
                flex-direction: column;
                gap: 1rem;
            }
            
            .quick-actions {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <div class="logo">
                üå± NEBO CLOUD
            </div>
            <div class="status-badge">
                <div class="live-dot"></div>
                <span id="statusText">Sistema Ativo - 25 dias</span>
            </div>
        </div>
    </header>

    <main class="container">
        <!-- A√ß√µes R√°pidas -->
        <div class="quick-actions">
            <div class="action-card urgent" onclick="aplicarSollem()">
                <div class="action-icon">üåø</div>
                <div class="action-title">Sollem HOJE</div>
                <div class="action-subtitle">14:00h per√≠odo escuro</div>
            </div>
            
            <div class="action-card" onclick="verCronograma()">
                <div class="action-icon">üìÖ</div>
                <div class="action-title">Cronograma</div>
                <div class="action-subtitle">Pr√≥ximas aplica√ß√µes</div>
            </div>
            
            <div class="action-card" onclick="analisePlanta()">
                <div class="action-icon">üì∏</div>
                <div class="action-title">An√°lise IA</div>
                <div class="action-subtitle">Diagn√≥stico visual</div>
            </div>
            
            <div class="action-card" onclick="statusSistema()">
                <div class="action-icon">ü§ñ</div>
                <div class="action-title">Sistema</div>
                <div class="action-subtitle">Automa√ß√£o completa</div>
            </div>
        </div>

        <div class="grid grid-2">
            <!-- Cronograma Inteligente -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">
                        üìÖ Cronograma Inteligente
                    </h2>
                </div>
                
                <div class="alert">
                    <div class="alert-title">üî• PR√ìXIMA A√á√ÉO CR√çTICA</div>
                    <div>Sollem foliar HOJE (07/07) √†s 14:00h - Per√≠odo escuro √≥timo</div>
                </div>

                <div class="timeline">
                    <div class="timeline-item urgent">
                        <div class="timeline-date">HOJE - 07/07</div>
                        <div class="timeline-content">
                            <div class="timeline-title">Sollem Foliar</div>
                            <div class="timeline-desc">1ml/L - Per√≠odo escuro (12:00-18:00)</div>
                        </div>
                    </div>
                    
                    <div class="timeline-item">
                        <div class="timeline-date">09/07</div>
                        <div class="timeline-content">
                            <div class="timeline-title">PSB POW + Leon Trich</div>
                            <div class="timeline-desc">Camas (0,25g/m¬≤) + Mudas (4ml/L)</div>
                        </div>
                    </div>
                    
                    <div class="timeline-item">
                        <div class="timeline-date">13/07</div>
                        <div class="timeline-content">
                            <div class="timeline-title">Alquifish + Bio Bokashi</div>
                            <div class="timeline-desc">3ml/L + 4ml/L (sequ√™ncia obrigat√≥ria)</div>
                        </div>
                    </div>
                    
                    <div class="timeline-item">
                        <div class="timeline-date">15-20/07</div>
                        <div class="timeline-content">
                            <div class="timeline-title">üéØ TRANSPLANTE TARGET</div>
                            <div class="timeline-desc">Mudas com 35-40 dias - Vigor m√°ximo</div>
                        </div>
                    </div>
                </div>

                <div style="display: flex; gap: 1rem; margin-top: 1.5rem;">
                    <button class="btn btn-primary" onclick="confirmarAplicacao()" style="flex: 1;">
                        ‚úÖ Executar Aplica√ß√£o
                    </button>
                    <button class="btn btn-secondary" onclick="adiarAplicacao()" style="flex: 1;">
                        ‚è∞ Adiar 2h
                    </button>
                </div>
            </div>

            <!-- M√©tricas e Status -->
            <div style="display: flex; flex-direction: column; gap: 2rem;">
                <!-- M√©tricas Cr√≠ticas -->
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">
                            üìä M√©tricas Cr√≠ticas
                        </h2>
                    </div>
                    
                    <div class="metrics-grid">
                        <div class="metric-card">
                            <div class="metric-value" id="diasCultivo">25</div>
                            <div class="metric-label">Dias Cultivo</div>
                        </div>
                        
                        <div class="metric-card">
                            <div class="metric-value">11</div>
                            <div class="metric-label">Plantas Ativas</div>
                        </div>
                        
                        <div class="metric-card">
                            <div class="metric-value">85%</div>
                            <div class="metric-label">Uniformidade</div>
                        </div>
                        
                        <div class="metric-card">
                            <div class="metric-value" id="diasTransplante">12</div>
                            <div class="metric-label">Dias p/ Transplante</div>
                        </div>
                    </div>
                </div>

                <!-- Status do Sistema -->
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">
                            ü§ñ Status Sistema
                        </h2>
                    </div>
                    
                    <div class="data-display">
                        <div class="data-row">
                            <span>üíß Blumat Irrigation</span>
                            <span style="color: var(--success);">‚úÖ Ativo</span>
                        </div>
                        
                        <div class="data-row">
                            <span>üì° Monitoramento 24/7</span>
                            <span style="color: var(--success);">‚úÖ Online</span>
                        </div>
                        
                        <div class="data-row">
                            <span>üß† IA Multi-Agente</span>
                            <span style="color: var(--success);">‚úÖ Ativo</span>
                        </div>
                        
                        <div class="data-row">
                            <span>‚òÅÔ∏è Backup Autom√°tico</span>
                            <span style="color: var(--success);">‚úÖ Sincronizado</span>
                        </div>
                    </div>

                    <div class="success-banner">
                        <strong>üèÜ Sistema Funcionando Perfeitamente!</strong><br>
                        <small>Todos os componentes operacionais</small>
                    </div>
                </div>
            </div>
        </div>

        <!-- Hist√≥rico de Aplica√ß√µes -->
        <div class="card" style="margin-top: 2rem;">
            <div class="card-header">
                <h2 class="card-title">
                    üìù Hist√≥rico Aplica√ß√µes
                </h2>
            </div>
            
            <div class="data-display">
                <div class="data-row">
                    <div>
                        <strong>Poda Estrat√©gica Camas</strong><br>
                        <small style="color: var(--text-secondary);">05/07 - 16:30h</small>
                    </div>
                    <span style="color: var(--success);">‚úÖ</span>
                </div>
                
                <div class="data-row">
                    <div>
                        <strong>Alquifish + Bio Bokashi</strong><br>
                        <small style="color: var(--text-secondary);">03/07 - 18:00h</small>
                    </div>
                    <span style="color: var(--success);">‚úÖ</span>
                </div>
                
                <div class="data-row">
                    <div>
                        <strong>Ch√° de Cinza Nebo</strong><br>
                        <small style="color: var(--text-secondary);">29/06 - 18:00h</small>
                    </div>
                    <span style="color: var(--success);">‚úÖ</span>
                </div>
            </div>
        </div>
    </main>

    <!-- Bot√£o Voz Flutuante -->
    <button class="floating-voice" id="voiceBtn" onclick="toggleVoice()" title="Comando por Voz (Ctrl+Space)">
        üé§
    </button>

    <!-- Status de Voz -->
    <div class="voice-status" id="voiceStatus">
        üé§ Ouvindo...
    </div>

    <!-- Notifica√ß√£o -->
    <div class="notification" id="notification">
        Notifica√ß√£o
    </div>

    <!-- Modal -->
    <div class="modal" id="modal">
        <div class="modal-content" id="modalContent">
            <!-- Conte√∫do do modal ser√° inserido aqui -->
        </div>
    </div>

    <script>
        // Configura√ß√µes do cultivo
        const CONFIG = {
            dataGerminacao: new Date('2025-06-10'),
            mudasTotal: 11,
            fotoperiodo: { luz: '18:00-12:00', escuro: '12:00-18:00' }
        };

        // Estado da aplica√ß√£o
        let isRecording = false;
        let recognition;
        let aplicacoesRealizadas = [];

        // Produtos e protocolos
        const PRODUTOS = {
            'Sollem': { dosagem: '1ml/L', aplicacao: 'foliar', intervalo: 15 },
            'PSB POW': { dosagem: '0,25g/m¬≤', aplicacao: 'rega', intervalo: 15 },
            'Leon Trich': { dosagem: '4ml/L', aplicacao: 'rega', intervalo: 15 },
            'Alquifish': { dosagem: '3ml/L', aplicacao: 'rega', intervalo: 10 },
            'Bio Bokashi': { dosagem: '4ml/L', aplicacao: 'rega', intervalo: 10 }
        };

        // √öltimas aplica√ß√µes conhecidas
        const ultimasAplicacoes = {
            'EM-1': new Date('2025-06-19'),
            'LMX': new Date('2025-07-03'),
            'Sollem': new Date('2025-06-23'),
            'PSB POW': new Date('2025-06-24'),
            'Leon Trich': new Date('2025-06-24'),
            'Ch√° Cinza': new Date('2025-06-29'),
            'Alquifish': new Date('2025-07-03'),
            'Bio Bokashi': new Date('2025-07-03')
        };

        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            atualizarMetricas();
            setInterval(atualizarMetricas, 60000);
            verificarAplicacaoPendente();
        });

        // Atualizar m√©tricas em tempo real
        function atualizarMetricas() {
            const hoje = new Date();
            const dias = Math.floor((hoje - CONFIG.dataGerminacao) / (1000 * 60 * 60 * 24));
            const diasTransplante = Math.max(0, 40 - dias);
            
            document.getElementById('diasCultivo').textContent = dias;
            document.getElementById('diasTransplante').textContent = diasTransplante;
            document.getElementById('statusText').textContent = `Sistema Ativo - ${dias} dias`;
        }

        // Verificar aplica√ß√£o pendente
        function verificarAplicacaoPendente() {
            const agora = new Date();
            const hora = agora.getHours();
            
            // Se √© pr√≥ximo das 14:00 e Sollem n√£o foi aplicado hoje
            if (hora >= 13 && hora <= 15) {
                const hoje = agora.toDateString();
                const sollemHoje = aplicacoesRealizadas.find(app => 
                    app.produto === 'Sollem' && 
                    new Date(app.timestamp).toDateString() === hoje
                );
                
                if (!sollemHoje) {
                    mostrarNotificacao('üî• Sollem foliar - Aplicar AGORA!');
                }
            }
        }

        // Fun√ß√µes das a√ß√µes r√°pidas
        function aplicarSollem() {
            mostrarModal(`
                <h3 style="color: var(--primary); margin-bottom: 1rem;">üåø Aplicar Sollem Foliar</h3>
                <div style="text-align: left; margin-bottom: 1.5rem;">
                    <div class="data-row">
                        <span><strong>Produto:</strong></span>
                        <span>Sollem</span>
                    </div>
                    <div class="data-row">
                        <span><strong>Dosagem:</strong></span>
                        <span>1ml/L</span>
                    </div>
                    <div class="data-row">
                        <span><strong>M√©todo:</strong></span>
                        <span>Aplica√ß√£o foliar</span>
                    </div>
                    <div class="data-row">
                        <span><strong>Timing:</strong></span>
                        <span>Per√≠odo escuro (12:00-18:00)</span>
                    </div>
                    <div class="data-row">
                        <span><strong>Local:</strong></span>
                        <span>11 mudas</span>
                    </div>
                </div>
                <div style="display: flex; gap: 1rem;">
                    <button class="btn btn-primary" onclick="confirmarAplicacao()" style="flex: 1;">Confirmar</button>
                    <button class="btn btn-secondary" onclick="fecharModal()" style="flex: 1;">Cancelar</button>
                </div>
            `);
        }

        function verCronograma() {
            mostrarModal(`
                <h3 style="color: var(--primary); margin-bottom: 1rem;">üìÖ Cronograma Completo</h3>
                <div style="text-align: left;">
                    <div style="margin-bottom: 1rem; padding: 1rem; background: rgba(245, 158, 11, 0.1); border-radius: 8px; border: 1px solid var(--warning);">
                        <strong>üî• HOJE (07/07):</strong> Sollem foliar - 14:00h
                    </div>
                    <div style="margin-bottom: 0.5rem;"><strong>09/07:</strong> PSB POW + Leon Trich - 18:00h</div>
                    <div style="margin-bottom: 0.5rem;"><strong>13/07:</strong> Alquifish + Bio Bokashi - 18:00h</div>
                    <div style="margin-bottom: 0.5rem;"><strong>15/07:</strong> Sollem intensivo - 14:00h</div>
                    <div style="margin-bottom: 0.5rem;"><strong>19/07:</strong> EM-1 sistema todo - 18:00h</div>
                    <div style="margin-top: 1rem; padding: 1rem; background: rgba(16, 185, 129, 0.1); border-radius: 8px; border: 1px solid var(--primary);">
                        <strong>üéØ TRANSPLANTE:</strong> 15-20/07 (35-40 dias)
                    </div>
                </div>
                <button class="btn btn-primary" onclick="fecharModal()" style="margin-top: 1rem;">Fechar</button>
            `);
        }

        function analisePlanta() {
            mostrarModal(`
                <h3 style="color: var(--primary); margin-bottom: 1rem;">üì∏ An√°lise Visual IA</h3>
                <div style="margin-bottom: 1.5rem;">
                    <div style="width: 100%; height: 200px; background: rgba(51, 65, 85, 0.5); border-radius: 12px; display: flex; align-items: center; justify-content: center; margin-bottom: 1rem; border: 2px dashed var(--border);">
                        <div style="text-align: center; color: var(--text-secondary);">
                            <div style="font-size: 3rem;">üì∏</div>
                            <div>Simular captura de foto</div>
                            <small>Clique para "analisar"</small>
                        </div>
                    </div>
                    <div style="text-align: left;">
                        <strong>ü§ñ An√°lise IA Simulada:</strong><br>
                        ‚úÖ Verde intenso saud√°vel<br>
                        ‚úÖ Vigor excepcional para 25 dias<br>
                        ‚úÖ Sistema radicular desenvolvido<br>
                        ‚úÖ Nenhuma defici√™ncia detectada<br>
                        ‚ö†Ô∏è Preparar transplante em 12-15 dias<br><br>
                        
                        <strong>üéØ Recomenda√ß√µes:</strong><br>
                        ‚Ä¢ Manter protocolo atual intensivo<br>
                        ‚Ä¢ Aplicar Sollem hoje conforme programado<br>
                        ‚Ä¢ Monitorar desenvolvimento radicular<br>
                        ‚Ä¢ Avaliar transplante em 15-20/07
                    </div>
                </div>
                <button class="btn btn-primary" onclick="fecharModal()">Fechar</button>
            `);
        }

        function statusSistema() {
            const uptime = Math.floor((new Date() - CONFIG.dataGerminacao) / (1000 * 60 * 60 * 24));
            
            mostrarModal(`
                <h3 style="color: var(--primary); margin-bottom: 1rem;">ü§ñ Status Completo do Sistema</h3>
                <div style="text-align: left;">
                    <div class="data-display">
                        <div class="data-row">
                            <span><strong>üèÉ Uptime Sistema:</strong></span>
                            <span style="color: var(--success);">${uptime} dias</span>
                        </div>
                        <div class="data-row">
                            <span><strong>üíß Sistema Blumat:</strong></span>
                            <span style="color: var(--success);">‚úÖ Funcionando</span>
                        </div>
                        <div class="data-row">
                            <span><strong>üå°Ô∏è Temperatura:</strong></span>
                            <span>22¬∞C</span>
                        </div>
                        <div class="data-row">
                            <span><strong>üíß Umidade:</strong></span>
                            <span>65%</span>
                        </div>
                        <div class="data-row">
                            <span><strong>üí° Fotoper√≠odo:</strong></span>
                            <span>18h/6h</span>
                        </div>
                        <div class="data-row">
                            <span><strong>üß† IA Multi-Agente:</strong></span>
                            <span style="color: var(--success);">5 agentes ativos</span>
                        </div>
                    </div>
                    
                    <div style="margin-top: 1rem; padding: 1rem; background: rgba(16, 185, 129, 0.1); border-radius: 8px; border: 1px solid var(--primary);">
                        <strong>üèÜ Performance Geral: EXCEPCIONAL</strong><br>
                        <small>Todos os sistemas operando em n√≠veis √≥timos</small>
                    </div>
                </div>
                <button class="btn btn-primary" onclick="fecharModal()" style="margin-top: 1rem;">Fechar</button>
            `);
        }

        function confirmarAplicacao() {
            const agora = new Date();
            const aplicacao = {
                produto: 'Sollem',
                timestamp: agora.toISOString(),
                dosagem: '1ml/L',
                metodo: 'foliar',
                sucesso: true
            };
            
            // Registrar aplica√ß√£o
            aplicacoesRealizadas.push(aplicacao);
            ultimasAplicacoes['Sollem'] = agora;
            
            // Salvar no localStorage
            localStorage.setItem('neboAplicacoes', JSON.stringify(aplicacoesRealizadas));
            
            mostrarModal(`
                <h3 style="color: var(--success); margin-bottom: 1rem;">‚úÖ Aplica√ß√£o Registrada!</h3>
                <div style="text-align: left; margin-bottom: 1.5rem;">
                    <div class="data-row">
                        <span><strong>Produto:</strong></span>
                        <span>Sollem foliar</span>
                    </div>
                    <div class="data-row">
                        <span><strong>Dosagem:</strong></span>
                        <span>1ml/L</span>
                    </div>
                    <div class="data-row">
                        <span><strong>Hor√°rio:</strong></span>
                        <span>${agora.toLocaleString('pt-BR')}</span>
                    </div>
                    <div class="data-row">
                        <span><strong>Pr√≥xima:</strong></span>
                        <span>15/07 (intensivo)</span>
                    </div>
                </div>
                <div style="padding: 1rem; background: rgba(16, 185, 129, 0.1); border-radius: 8px; border: 1px solid var(--primary); margin-bottom: 1rem;">
                    üå± Aplica√ß√£o sincronizada com todos os sistemas!<br>
                    <small>Dados salvos localmente e prontos para backup</small>
                </div>
                <button class="btn btn-primary" onclick="fecharModal(); atualizarCronograma(); mostrarNotificacao('Sollem aplicado com sucesso!');">Concluir</button>
            `);
        }

        function adiarAplicacao() {
            const novoHorario = new Date();
            novoHorario.setHours(novoHorario.getHours() + 2);
            const horarioFormatado = novoHorario.toLocaleTimeString('pt-BR', {hour: '2-digit', minute: '2-digit'});
            
            mostrarModal(`
                <h3 style="color: var(--warning); margin-bottom: 1rem;">‚è∞ Aplica√ß√£o Adiada</h3>
                <div style="text-align: center; margin-bottom: 1.5rem;">
                    <div style="font-size: 1.2rem; margin-bottom: 0.5rem;">Novo hor√°rio: <strong>${horarioFormatado}</strong></div>
                    <div style="color: var(--text-secondary); font-size: 0.875rem;">Lembrete ser√° reativado automaticamente</div>
                </div>
                <div style="padding: 1rem; background: rgba(245, 158, 11, 0.1); border-radius: 8px; border: 1px solid var(--warning);">
                    ‚ö†Ô∏è Lembre-se: Aplica√ß√£o foliar deve ser no per√≠odo escuro!
                </div>
                <button class="btn btn-primary" onclick="fecharModal(); setTimeout(() => mostrarNotificacao('‚è∞ Hora de aplicar Sollem!'), 7200000);" style="margin-top: 1rem;">Confirmar</button>
            `);
        }

        function atualizarCronograma() {
            // Atualizar timeline visual
            const timelineItem = document.querySelector('.timeline-item.urgent');
            if (timelineItem) {
                timelineItem.classList.remove('urgent');
                timelineItem.style.opacity = '0.6';
                const title = timelineItem.querySelector('.timeline-title');
                title.innerHTML = '‚úÖ Sollem Foliar Aplicado';
                
                const desc = timelineItem.querySelector('.timeline-desc');
                desc.innerHTML = 'Conclu√≠do - Pr√≥ximo: 15/07';
            }
            
            // Atualizar card de a√ß√£o
            const urgentCard = document.querySelector('.action-card.urgent');
            if (urgentCard) {
                urgentCard.classList.remove('urgent');
                urgentCard.innerHTML = `
                    <div class="action-icon">‚úÖ</div>
                    <div class="action-title">Sollem Completo</div>
                    <div class="action-subtitle">Pr√≥ximo: 09/07 PSB POW</div>
                `;
            }
            
            // Atualizar alerta
            const alert = document.querySelector('.alert');
            if (alert) {
                alert.innerHTML = `
                    <div class="alert-title">‚úÖ APLICA√á√ÉO CONCLU√çDA</div>
                    <div>Pr√≥xima a√ß√£o: PSB POW + Leon Trich em 09/07 √†s 18:00h</div>
                `;
                alert.style.background = 'rgba(34, 197, 94, 0.1)';
                alert.style.borderColor = 'var(--success)';
                alert.querySelector('.alert-title').style.color = 'var(--success)';
            }
        }

        // Sistema de voz
        function toggleVoice() {
            const btn = document.getElementById('voiceBtn');
            const status = document.getElementById('voiceStatus');
            
            if (!isRecording) {
                iniciarGravacao();
                btn.classList.add('recording');
                btn.innerHTML = 'üî¥';
                status.style.display = 'block';
                isRecording = true;
            } else {
                pararGravacao();
                btn.classList.remove('recording');
                btn.innerHTML = 'üé§';
                status.style.display = 'none';
                isRecording = false;
            }
        }

        function iniciarGravacao() {
            if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                const SpeechRecognition = window.webkitSpeechRecognition || window.SpeechRecognition;
                recognition = new SpeechRecognition();
                recognition.continuous = false;
                recognition.interimResults = false;
                recognition.lang = 'pt-BR';

                recognition.onresult = function(event) {
                    const transcript = event.results[0][0].transcript.toLowerCase();
                    processarComandoVoz(transcript);
                };

                recognition.onerror = function(event) {
                    console.error('Erro no reconhecimento:', event.error);
                    toggleVoice();
                };

                recognition.start();
            } else {
                mostrarModal(`
                    <h3 style="color: var(--error);">‚ùå Erro</h3>
                    <p>Seu navegador n√£o suporta reconhecimento de voz.</p>
                    <p><small>Recomendado: Chrome ou Edge</small></p>
                    <button class="btn btn-primary" onclick="fecharModal()">Fechar</button>
                `);
            }
        }

        function pararGravacao() {
            if (recognition) {
                recognition.stop();
            }
        }

        function processarComandoVoz(comando) {
            let resposta = '';
            let acao = null;

            console.log('Comando de voz detectado:', comando);

            if (comando.includes('sollem') && (comando.includes('aplicado') || comando.includes('aplicar'))) {
                resposta = 'Sollem foliar registrado com sucesso. Pr√≥xima aplica√ß√£o em 15 de julho.';
                acao = confirmarAplicacao;
            } else if (comando.includes('status') || comando.includes('como est√£o as plantas')) {
                resposta = 'Todas as 11 mudas est√£o com vigor excepcional. Altura m√©dia 17 cent√≠metros. Uniformidade 85%.';
                acao = statusSistema;
            } else if (comando.includes('pr√≥xima aplica√ß√£o') || comando.includes('cronograma')) {
                resposta = 'Pr√≥xima aplica√ß√£o: PSB POW mais Leon Trich no dia 9 de julho √†s 18 horas.';
                acao = verCronograma;
            } else if (comando.includes('transplante')) {
                resposta = 'Transplante programado entre 15 e 20 de julho. Mudas com 35 a 40 dias, vigor m√°ximo.';
            } else if (comando.includes('analisar') || comando.includes('foto') || comando.includes('an√°lise')) {
                resposta = 'Abrindo an√°lise visual AI. Diagn√≥stico autom√°tico das plantas.';
                acao = analisePlanta;
            } else if (comando.includes('sistema') || comando.includes('automa√ß√£o')) {
                resposta = 'Sistema funcionando perfeitamente. Blumat ativo, monitoramento 24 horas, IA operacional.';
                acao = statusSistema;
            } else {
                resposta = 'Comando n√£o reconhecido. Tente: aplicar sollem, status plantas, cronograma, analisar plantas ou sistema.';
            }

            // Falar resposta
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(resposta);
                utterance.lang = 'pt-BR';
                utterance.rate = 0.9;
                speechSynthesis.speak(utterance);
            }

            // Mostrar resposta visual
            mostrarNotificacao(`üé§ ${resposta}`);

            // Executar a√ß√£o se houver
            if (acao) {
                setTimeout(acao, 1500);
            }

            toggleVoice();
        }

        // Fun√ß√µes do modal
        function mostrarModal(conteudo) {
            document.getElementById('modalContent').innerHTML = conteudo;
            document.getElementById('modal').style.display = 'flex';
        }

        function fecharModal() {
            document.getElementById('modal').style.display = 'none';
        }

        // Notifica√ß√µes
        function mostrarNotificacao(texto) {
            const notification = document.getElementById('notification');
            notification.textContent = texto;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 4000);
        }

        // Fechar modal clicando fora
        document.getElementById('modal').addEventListener('click', function(e) {
            if (e.target === this) {
                fecharModal();
            }
        });

        // Atalhos de teclado
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                fecharModal();
                if (isRecording) toggleVoice();
            } else if (e.key === ' ' && e.ctrlKey) {
                e.preventDefault();
                toggleVoice();
            } else if (e.key === '1' && e.ctrlKey) {
                e.preventDefault();
                aplicarSollem();
            } else if (e.key === '2' && e.ctrlKey) {
                e.preventDefault();
                verCronograma();
            } else if (e.key === '3' && e.ctrlKey) {
                e.preventDefault();
                analisePlanta();
            } else if (e.key === '4' && e.ctrlKey) {
                e.preventDefault();
                statusSistema();
            }
        });

        // Carregar dados salvos
        function carregarDados() {
            const dadosSalvos = localStorage.getItem('neboAplicacoes');
            if (dadosSalvos) {
                aplicacoesRealizadas = JSON.parse(dadosSalvos);
            }
        }

        // Backup autom√°tico (simulado)
        function backupAutomatico() {
            const dados = {
                timestamp: new Date().toISOString(),
                diasCultivo: Math.floor((new Date() - CONFIG.dataGerminacao) / (1000 * 60 * 60 * 24)),
                aplicacoes: aplicacoesRealizadas,
                ultimasAplicacoes: ultimasAplicacoes,
                status: 'ativo'
            };
            
            localStorage.setItem('neboBackup', JSON.stringify(dados));
            console.log('üîÑ Backup autom√°tico realizado:', new Date().toLocaleString());
        }

        // PWA Installation
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            
            setTimeout(() => {
                mostrarModal(`
                    <h3 style="color: var(--primary); margin-bottom: 1rem;">üì± Instalar NEBO Cloud</h3>
                    <p style="margin-bottom: 1.5rem;">Instale o app para acesso r√°pido e uso offline!</p>
                    <div style="text-align: center; margin-bottom: 1rem;">
                        <div style="font-size: 4rem;">üì±</div>
                    </div>
                    <div style="display: flex; gap: 1rem;">
                        <button class="btn btn-primary" onclick="instalarPWA()" style="flex: 1;">üì≤ Instalar</button>
                        <button class="btn btn-secondary" onclick="fecharModal()" style="flex: 1;">Agora n√£o</button>
                    </div>
                `);
            }, 10000);
        });

        function instalarPWA() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        mostrarNotificacao('üì± NEBO Cloud instalado com sucesso!');
                    }
                    deferredPrompt = null;
                });
            }
            fecharModal();
        }

        // Inicializa√ß√£o completa
        carregarDados();
        setInterval(backupAutomatico, 300000); // Backup a cada 5 minutos
        
        // Mostrar mensagem de boas-vindas
        setTimeout(() => {
            mostrarNotificacao('üå± NEBO Cloud iniciado com sucesso!');
        }, 1000);

        console.log('üå± NEBO CLOUD - Sistema inicializado com sucesso!');
        console.log('üé§ Comandos de voz: Ctrl+Space');
        console.log('‚ö° A√ß√µes r√°pidas: Ctrl+1, Ctrl+2, Ctrl+3, Ctrl+4');
        console.log('üì± Interface responsiva ativa');
        console.log('üíæ Backup autom√°tico ativo');
    </script>
</body>
</html>