---
criado: {{date}}
tipo: template
categoria: RPI Workflow
fase: Master Planning
uso: Large refactorings requiring multiple sub-plans
---

# üéØ RPI MASTER PLAN: [PROJETO/REFATORA√á√ÉO]

**Criado em:** [DD/MMM/YYYY]
**Respons√°vel:** [Nome/Agente]
**Estimativa total:** [X semanas/meses]
**Status:** [PLANEJAMENTO / EM EXECU√á√ÉO / COMPLETO]

---

## üìã OVERVIEW

### Objetivo Principal

[Descreva em 1-2 frases o objetivo final desta refatora√ß√£o/feature]

**Exemplo:**
> Refatorar todo o sistema de autentica√ß√£o do monorepo, substituindo JWT por OAuth2, garantindo zero downtime e 100% de compatibilidade retroativa.

### Scope (O que est√° inclu√≠do)

- ‚úÖ [Item de scope 1]
- ‚úÖ [Item de scope 2]
- ‚úÖ [Item de scope 3]
- ‚úÖ [Item de scope 4]

### Out of Scope (O que N√ÉO est√° inclu√≠do)

- ‚ùå [Item fora do scope 1]
- ‚ùå [Item fora do scope 2]
- ‚ùå [Item fora do scope 3]

### Success Criteria (Como saberemos que est√° completo?)

- [ ] **Crit√©rio 1:** [Descri√ß√£o mensur√°vel]
- [ ] **Crit√©rio 2:** [Descri√ß√£o mensur√°vel]
- [ ] **Crit√©rio 3:** [Descri√ß√£o mensur√°vel]
- [ ] **Crit√©rio 4:** [Descri√ß√£o mensur√°vel]

---

## üîç RESEARCH PHASE - SUMMARY

### Research Output Reference

**Documento:** `[caminho/para/TEMPLATE_RPI_RESEARCH_OUTPUT.md]`
**Completado em:** [DD/MMM/YYYY]

### Key Findings (Resumo executivo da pesquisa)

#### Contexto Atual

[Breve descri√ß√£o do estado atual do codebase]

**Exemplo:**
> Sistema atual usa JWT com refresh tokens, 47 endpoints diferentes, 12 servi√ßos dependentes, 3 bancos de dados com schemas de usu√°rio separados.

#### Principais Problemas Identificados

1. **[Problema 1]:** [Descri√ß√£o] - **Impacto:** [Alto/M√©dio/Baixo]
2. **[Problema 2]:** [Descri√ß√£o] - **Impacto:** [Alto/M√©dio/Baixo]
3. **[Problema 3]:** [Descri√ß√£o] - **Impacto:** [Alto/M√©dio/Baixo]

#### Riscos Identificados

- üö® **[Risco Cr√≠tico 1]:** [Descri√ß√£o] - **Mitiga√ß√£o:** [Como vamos lidar]
- ‚ö†Ô∏è **[Risco M√©dio 1]:** [Descri√ß√£o] - **Mitiga√ß√£o:** [Como vamos lidar]
- ‚ÑπÔ∏è **[Risco Baixo 1]:** [Descri√ß√£o] - **Mitiga√ß√£o:** [Como vamos lidar]

#### Dependencies & External Systems

- [Sistema/Servi√ßo 1] - [Como ser√° impactado]
- [Sistema/Servi√ßo 2] - [Como ser√° impactado]
- [Sistema/Servi√ßo 3] - [Como ser√° impactado]

---

## üìä MASTER PLAN BREAKDOWN

### High-Level Phases

```
[FASE 1] ‚Üí [FASE 2] ‚Üí [FASE 3] ‚Üí [FASE 4] ‚Üí [FASE 5]
  ‚Üì          ‚Üì          ‚Üì          ‚Üì          ‚Üì
 Sub-       Sub-       Sub-       Sub-       Sub-
 Plans      Plans      Plans      Plans      Plans
```

### Phase Overview

| Fase | Nome | Sub-Plans | Estimativa | Status |
|------|------|-----------|------------|--------|
| 1    | [Nome Fase 1] | [X] | [Y semanas] | [ ] |
| 2    | [Nome Fase 2] | [X] | [Y semanas] | [ ] |
| 3    | [Nome Fase 3] | [X] | [Y semanas] | [ ] |
| 4    | [Nome Fase 4] | [X] | [Y semanas] | [ ] |
| 5    | [Nome Fase 5] | [X] | [Y semanas] | [ ] |

**Estimativa Total:** [X semanas/meses]

---

## üóÇÔ∏è SUB-PLANS (Detailed Breakdown)

### FASE 1: [NOME DA FASE]

**Objetivo:** [O que esta fase alcan√ßa]
**Dura√ß√£o estimada:** [X semanas]
**Pr√©-requisitos:** [Nenhum / Lista]

#### Sub-Plan 1.1: [Nome]

**Documento:** `[caminho/para/RPI_IMPLEMENTATION_PHASE_1_1.md]`
**Status:** [ ] N√£o iniciado / [ ] Em progresso / [ ] Completo

**Objetivo:**
[Descri√ß√£o breve do que este sub-plan faz]

**Entreg√°veis:**
- [ ] [Entreg√°vel 1]
- [ ] [Entreg√°vel 2]
- [ ] [Entreg√°vel 3]

**Valida√ß√£o:**
- [ ] Todos testes passando
- [ ] Build bem-sucedido
- [ ] [Crit√©rio espec√≠fico]

**Estimativa:** [X dias/horas]

---

#### Sub-Plan 1.2: [Nome]

**Documento:** `[caminho/para/RPI_IMPLEMENTATION_PHASE_1_2.md]`
**Status:** [ ] N√£o iniciado / [ ] Em progresso / [ ] Completo

**Objetivo:**
[Descri√ß√£o breve do que este sub-plan faz]

**Entreg√°veis:**
- [ ] [Entreg√°vel 1]
- [ ] [Entreg√°vel 2]
- [ ] [Entreg√°vel 3]

**Valida√ß√£o:**
- [ ] Todos testes passando
- [ ] Build bem-sucedido
- [ ] [Crit√©rio espec√≠fico]

**Estimativa:** [X dias/horas]

---

#### Sub-Plan 1.3: [Nome]

[Repita o padr√£o acima para cada sub-plan]

---

### FASE 2: [NOME DA FASE]

**Objetivo:** [O que esta fase alcan√ßa]
**Dura√ß√£o estimada:** [X semanas]
**Pr√©-requisitos:** Fase 1 completa

#### Sub-Plan 2.1: [Nome]

[Use mesmo template que Fase 1]

---

#### Sub-Plan 2.2: [Nome]

[Use mesmo template que Fase 1]

---

### FASE 3: [NOME DA FASE]

[Continue o padr√£o para todas as fases necess√°rias]

---

## üìÖ TIMELINE & MILESTONES

### Timeline Visual

```
Semana 1-2:  [‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë] Fase 1 (80%)
Semana 3-4:  [‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë] Fase 2 (0%)
Semana 5-6:  [‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë] Fase 3 (0%)
Semana 7-8:  [‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë] Fase 4 (0%)
Semana 9-10: [‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë] Fase 5 (0%)
```

### Major Milestones

- [ ] **Milestone 1 (Semana X):** [Nome] - [Crit√©rio de sucesso]
- [ ] **Milestone 2 (Semana Y):** [Nome] - [Crit√©rio de sucesso]
- [ ] **Milestone 3 (Semana Z):** [Nome] - [Crit√©rio de sucesso]
- [ ] **Milestone 4 (Final):** [Nome] - [Crit√©rio de sucesso]

---

## üîÑ ROLLBACK & CONTINGENCY

### Rollback Strategy

**Se algo der errado, como voltamos atr√°s?**

1. **Fase 1 Rollback:** [Descri√ß√£o de como reverter]
2. **Fase 2 Rollback:** [Descri√ß√£o de como reverter]
3. **Fase 3 Rollback:** [Descri√ß√£o de como reverter]

### Contingency Plans

**Plano B se problemas surgirem:**

- **Se [Problema X] ocorrer:** [Plano alternativo]
- **Se [Problema Y] ocorrer:** [Plano alternativo]
- **Se [Problema Z] ocorrer:** [Plano alternativo]

---

## ‚úÖ VALIDATION & TESTING STRATEGY

### Testing Approach

**Como validaremos cada fase?**

#### Unit Tests
- [ ] [√Årea 1] - [X% coverage target]
- [ ] [√Årea 2] - [X% coverage target]
- [ ] [√Årea 3] - [X% coverage target]

#### Integration Tests
- [ ] [Integra√ß√£o 1]
- [ ] [Integra√ß√£o 2]
- [ ] [Integra√ß√£o 3]

#### E2E Tests
- [ ] [Fluxo cr√≠tico 1]
- [ ] [Fluxo cr√≠tico 2]
- [ ] [Fluxo cr√≠tico 3]

#### Manual QA
- [ ] [Checklist item 1]
- [ ] [Checklist item 2]
- [ ] [Checklist item 3]

### Success Metrics

**Como mediremos o sucesso?**

- **Performance:** [M√©trica alvo] (ex: < 200ms response time)
- **Reliability:** [M√©trica alvo] (ex: 99.9% uptime)
- **Coverage:** [M√©trica alvo] (ex: 100% casos cr√≠ticos)
- **[M√©trica custom]:** [Alvo]

---

## üìù COMMUNICATION PLAN

### Stakeholders

| Stakeholder | Papel | Comunica√ß√£o | Frequ√™ncia |
|-------------|-------|-------------|------------|
| [Nome/Time] | [Papel] | [M√©todo] | [Frequ√™ncia] |
| [Nome/Time] | [Papel] | [M√©todo] | [Frequ√™ncia] |
| [Nome/Time] | [Papel] | [M√©todo] | [Frequ√™ncia] |

### Status Updates

**Como comunicaremos progresso?**

- **Daily:** [Formato] (ex: Slack update)
- **Weekly:** [Formato] (ex: Written summary)
- **Milestone:** [Formato] (ex: Demo + retrospective)

---

## üöÄ EXECUTION TRACKER

### Current Phase

**Fase Atual:** [N√∫mero e Nome]
**Sub-Plan Atual:** [N√∫mero e Nome]
**Status:** [Descri√ß√£o]
**√öltima atualiza√ß√£o:** [DD/MMM/YYYY HH:MM]

### Progress Overview

**Completo:** [X/Y sub-plans] ([Z%])

```
Overall Progress: [‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë] 80%

Fase 1: [‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà] 100% ‚úÖ
Fase 2: [‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë]  80% üîÑ
Fase 3: [‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë]   0% ‚è∏Ô∏è
Fase 4: [‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë]   0% ‚è∏Ô∏è
Fase 5: [‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë]   0% ‚è∏Ô∏è
```

### Blockers & Issues

- üö® **[Blocker cr√≠tico]:** [Descri√ß√£o] - **Owner:** [Nome] - **ETA:** [Data]
- ‚ö†Ô∏è **[Issue importante]:** [Descri√ß√£o] - **Owner:** [Nome] - **ETA:** [Data]

---

## üìö RESOURCES & REFERENCES

### Documentation

- [[Link para documenta√ß√£o relevante 1]]
- [[Link para documenta√ß√£o relevante 2]]
- [[Link para documenta√ß√£o relevante 3]]

### Code References

- `[caminho/arquivo/chave.ts]` - [Descri√ß√£o]
- `[caminho/arquivo/chave.ts]` - [Descri√ß√£o]

### External Resources

- [Nome do recurso](URL) - [Descri√ß√£o]
- [Nome do recurso](URL) - [Descri√ß√£o]

---

## üìä POST-MORTEM (Ap√≥s conclus√£o)

### What Went Well

- [Item 1]
- [Item 2]
- [Item 3]

### What Could Be Improved

- [Item 1]
- [Item 2]
- [Item 3]

### Lessons Learned

- [Li√ß√£o 1]
- [Li√ß√£o 2]
- [Li√ß√£o 3]

### Metrics Final

- **Estimativa vs Real:** [X semanas estimado] vs [Y semanas real]
- **Qualidade:** [Bugs encontrados] / [Cobertura final]
- **Performance:** [M√©tricas finais]

---

## üéØ EXEMPLO PREENCHIDO

```markdown
# üéØ RPI MASTER PLAN: Auth System OAuth2 Migration

**Criado em:** 15/JAN/2026
**Respons√°vel:** Claude Architect + Team
**Estimativa total:** 8 semanas
**Status:** EM EXECU√á√ÉO

## üìã OVERVIEW

### Objetivo Principal

Migrar todo o sistema de autentica√ß√£o do monorepo de JWT para OAuth2, garantindo zero downtime, compatibilidade retroativa durante transi√ß√£o, e melhorando seguran√ßa com 2FA.

### Scope

- ‚úÖ Implementar OAuth2 server (Authorization Code Flow)
- ‚úÖ Migrar 47 endpoints de JWT para OAuth2
- ‚úÖ Atualizar 12 servi√ßos dependentes
- ‚úÖ Unificar 3 bancos de dados de usu√°rios
- ‚úÖ Adicionar 2FA (TOTP)
- ‚úÖ Backward compatibility durante 3 meses

### Out of Scope

- ‚ùå Social logins (Facebook, Google) - Fase 2
- ‚ùå Biometric authentication - Futuro
- ‚ùå Migration de usu√°rios inativos (>2 anos)

## üîç RESEARCH PHASE - SUMMARY

**Documento:** `docs/RPI_AUTH_RESEARCH_2026.md`

### Key Findings

**Contexto Atual:**
- 3 sistemas de auth separados (legacy, v2, v3)
- 47 endpoints com implementa√ß√µes inconsistentes
- Sem testes de integra√ß√£o (0% coverage)
- 12 servi√ßos com hard-dependency em JWT format

**Principais Problemas:**
1. **Security gaps:** Tokens sem expira√ß√£o em 8 endpoints - **Impacto:** Alto
2. **Database fragmentation:** User data em 3 DBs diferentes - **Impacto:** Alto
3. **No 2FA:** Sistema cr√≠tico sem second factor - **Impacto:** M√©dio

## üìä MASTER PLAN BREAKDOWN

### Phase Overview

| Fase | Nome | Sub-Plans | Estimativa | Status |
|------|------|-----------|------------|--------|
| 1    | Foundation | 3 | 2 semanas | [X] ‚úÖ |
| 2    | OAuth2 Core | 4 | 2 semanas | [X] üîÑ |
| 3    | Endpoint Migration | 6 | 2 semanas | [ ] |
| 4    | Service Updates | 3 | 1 semana | [ ] |
| 5    | Testing & Rollout | 2 | 1 semana | [ ] |

## üóÇÔ∏è SUB-PLANS

### FASE 1: Foundation ‚úÖ

#### Sub-Plan 1.1: Database Unification
**Status:** [X] Completo
**Valida√ß√£o:** ‚úÖ 100% tests passing, 0 regressions

#### Sub-Plan 1.2: OAuth2 Server Setup
**Status:** [X] Completo
**Valida√ß√£o:** ‚úÖ Can issue/validate tokens

#### Sub-Plan 1.3: Backward Compat Layer
**Status:** [X] Completo
**Valida√ß√£o:** ‚úÖ Old JWT tokens still work

### FASE 2: OAuth2 Core üîÑ (CURRENT)

#### Sub-Plan 2.1: Authorization Code Flow
**Status:** [X] Em progresso (80%)
**Documento:** `docs/RPI_IMPL_PHASE_2_1.md`

[... continua]
```

---

## üìå NOTAS & ASSUMPTIONS

### Assumptions

- [Assumption 1]
- [Assumption 2]
- [Assumption 3]

### Dependencies

- [Depend√™ncia externa 1]
- [Depend√™ncia externa 2]

### Open Questions

- [ ] **Q1:** [Pergunta] - **Owner:** [Nome]
- [ ] **Q2:** [Pergunta] - **Owner:** [Nome]

---

**Template Version:** 1.0
**Criado por:** Claude Architect üèõÔ∏è
**√öltima atualiza√ß√£o:** {{date}}
